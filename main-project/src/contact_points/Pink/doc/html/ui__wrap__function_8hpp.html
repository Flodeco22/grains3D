<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pink: ui_wrap_function.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Pink<span id="projectnumber">&#160;0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,true,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">ui_wrap_function.hpp File Reference<div class="ingroups"><a class="el" href="group__development.html">Development</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>This is a helper function for exporting Pink C functions in Python. This file defines 'UI_WRAP_FUNCTION'.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is a helper function for exporting Pink C functions in Python. This file defines 'UI_WRAP_FUNCTION'. </p>
<p>This is a helper function for exporting Pink C functions in Python. This file defines 'UI_WRAP_MALLOC'.</p>
<h1><a class="anchor" id="note"></a>
Note</h1>
<p>For debugging macro definitions uncomment the debug part at the end of and the beginning of the file. Then you can use the</p>
<pre class="fragment">g++ -E -P file.cpp -o file_pp.cpp
</pre><p>commands, which outputs the source code after preprocessing. Also</p>
<pre class="fragment">astyle -A3 -z2 -k1 -s2 -j file_pp.cpp 
</pre><p>Indents the preprocessed code and inserts lots of newlines, which improoves very much the readability of the code.</p>
<h1><a class="anchor" id="export"></a>
Exporting functions from C</h1>
<p>For exporting functions from Pink you should make them follow the <a class="el" href="dev_conventions.html">Conventions for developing Pink operators</a>.</p>
<p>You may use printf and you may call exit(1) if there's an error. type_k can be any type that python recognizes (int, float, ...) and xvimage* The return value is 1 on success and 0 otherwise. To export this function you should include a function call in pypink.cpp of the form</p>
<div class="fragment"><div class="line">UI_WRAP_FUNCION(</div>
<div class="line"><span class="stringliteral">&quot;function&#39;s name in Python&quot;</span>,</div>
<div class="line">pink_c_function, </div>
<div class="line">(arg(<span class="stringliteral">&quot;argument 1 name&quot;</span>), arg(<span class="stringliteral">&quot;argument 2 name&quot;</span>), ..., arg(argument n name)),</div>
<div class="line">doc__my_c_function__c__</div>
<div class="line">)</div>
<div class="line"><span class="preprocessor">#include BOOST_PP_UPDATE_COUNTER()</span></div>
</div><!-- fragment --><p>Example: </p><div class="fragment"><div class="line">UI_WRAP_FUNCTION(</div>
<div class="line"><span class="stringliteral">&quot;ptisolated&quot;</span>,</div>
<div class="line">lptisolated,</div>
<div class="line">( arg(<span class="stringliteral">&quot;image&quot;</span>), arg(<span class="stringliteral">&quot;connexity&quot;</span>) ),</div>
<div class="line">doc__ptisolated__c__</div>
<div class="line">);</div>
<div class="line"><span class="preprocessor">#include BOOST_PP_UPDATE_COUNTER()</span></div>
</div><!-- fragment --><h1><a class="anchor" id="advanced"></a>
Advanced</h1>
<p>This file contains C++ macro language and template metaprogramming, which is difficult to understand. The file is first treated with the preprocessor. The generated code looks like this:</p>
<div class="fragment"><div class="line"><span class="comment">// the wrapper uses boost enable_if class for conditional compilation</span></div>
<div class="line"><span class="comment">// this is the base class declaration</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <span class="keyword">class</span> enabled = <span class="keywordtype">void</span>&gt;</div>
<div class="line"><span class="keyword">struct </span>instance0 { };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// for every number of arguments there is a special wrapper </span></div>
<div class="line"><span class="comment">// the above instantiation only occurs if the number of arguments</span></div>
<div class="line"><span class="comment">// (including the &#39;image&#39; object) is 1</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> FA&gt;</div>
<div class="line"><span class="keyword">struct </span>instance0&lt; FA, typename enable_if&lt; is_same&lt;FA, int_&lt;1&gt; &gt; &gt;::type &gt;</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Fn, <span class="keyword">class</span> Args&gt;</div>
<div class="line">  <span class="keywordtype">void</span> define(<span class="keyword">const</span> <span class="keywordtype">char</span>* fname, Fn fn, Args args, <span class="keyword">const</span> <span class="keywordtype">char</span>* doc)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// decomposition of the function for parameters</span></div>
<div class="line">    <span class="keyword">typedef</span> <span class="keyword">struct </span>decompose&lt;Fn&gt; FT;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// for each image type in Pink the appropriate &#39;make_function&#39;</span></div>
<div class="line">    <span class="comment">// macro is called</span></div>
<div class="line">    def(fname, make_function&lt; char_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; short_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; int_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; float_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; double_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; fcomplex_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; dcomplex_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> FA&gt; <span class="keyword">struct </span>instance0&lt; FA, typename enable_if&lt; is_same&lt;FA, int_&lt;2&gt; &gt; &gt;::type &gt;</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Fn, <span class="keyword">class</span> Args&gt;</div>
<div class="line">  <span class="keywordtype">void</span> define(<span class="keyword">const</span> <span class="keywordtype">char</span>* fname, Fn fn, Args args, <span class="keyword">const</span> <span class="keywordtype">char</span>* doc)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">typedef</span> <span class="keyword">struct </span>decompose&lt;Fn&gt; FT;</div>
<div class="line">    def(fname, make_function&lt; char_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; short_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; int_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; float_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; double_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; fcomplex_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; dcomplex_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> FA&gt; <span class="keyword">struct </span>instance0&lt; FA, typename enable_if&lt; is_same&lt;FA, int_&lt;3&gt; &gt; &gt;::type &gt;</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Fn, <span class="keyword">class</span> Args&gt;</div>
<div class="line">  <span class="keywordtype">void</span> define(<span class="keyword">const</span> <span class="keywordtype">char</span>* fname, Fn fn, Args args, <span class="keyword">const</span> <span class="keywordtype">char</span>* doc)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">typedef</span> <span class="keyword">struct </span>decompose&lt;Fn&gt; FT;</div>
<div class="line">    def(fname, make_function&lt; char_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; short_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; int_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; float_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; double_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; fcomplex_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_function&lt; dcomplex_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// this function does the first decomposition and the </span></div>
<div class="line"><span class="comment">// appropriate wrapper class instantiation</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> Fn, <span class="keyword">class</span> Args&gt;</div>
<div class="line"><span class="keywordtype">void</span> call0(<span class="keyword">const</span> <span class="keywordtype">char</span>* fname, Fn fn, Args args, <span class="keyword">const</span> <span class="keywordtype">char</span>* doc)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> FA = decompose&lt;Fn&gt;::arity;</div>
<div class="line">  instance0&lt; int_&lt;FA&gt; &gt; wrapped_function;</div>
<div class="line">  wrapped_function.define(fname, fn, args, doc);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// this is a helper function so we wouldn&#39;t have to </span></div>
<div class="line"><span class="comment">// call call0 again in &#39;BOOST_PYTHON_MODULE&#39;</span></div>
<div class="line"><span class="keywordtype">void</span> export_function0()</div>
<div class="line">{</div>
<div class="line">  call0(<span class="stringliteral">&quot;greet&quot;</span>, greet, (arg(<span class="stringliteral">&quot;image&quot;</span>), (arg(<span class="stringliteral">&quot;int&quot;</span>))), <span class="stringliteral">&quot;WRITE ME!!&quot;</span>);</div>
<div class="line">};</div>
</div><!-- fragment --><p>The macro generates the wrapper 'instance' for each number of parameters. The template takes the specified parameters and wraps the function in Python. The most important part of the macro is the conversion of the 'xvimage*' pointer into the appropriate image class (like 'char_image').</p>
<h1><a class="anchor" id="note"></a>
Note</h1>
<p>For debugging macro definitions uncomment the debug part at the end of and the beginning of the file. Then you can use the</p>
<pre class="fragment">g++ -E -P file.cpp -o file_pp.cpp
</pre><p>commands, which outputs the source code after preprocessing. Also</p>
<pre class="fragment">astyle -A3 -z2 -k1 -s2 -j file_pp.cpp 
</pre><p>Indents the preprocessed code and inserts lots of newlines, which improoves very much the readability of the code.</p>
<h1><a class="anchor" id="export"></a>
Exporting functions from C</h1>
<p>For exporting functions from Pink you should make them follow the <a class="el" href="dev_conventions.html">Conventions for developing Pink operators</a>.</p>
<p>You may use printf and you may call exit(1) if there's an error. type_k can be any type that python recognizes (int, float, ...) and xvimage* The return value is 1 on success and 0 otherwise. To export this function you should include a function call in pypink.cpp of the form</p>
<div class="fragment"><div class="line">UI_WRAP_FUNCION(</div>
<div class="line"><span class="stringliteral">&quot;function&#39;s name in Python&quot;</span>,</div>
<div class="line">pink_c_function, </div>
<div class="line">(arg(<span class="stringliteral">&quot;argument 1 name&quot;</span>), arg(<span class="stringliteral">&quot;argument 2 name&quot;</span>), ..., arg(argument n name)),</div>
<div class="line">doc__my_c_function__c__</div>
<div class="line">)</div>
<div class="line"><span class="preprocessor">#include BOOST_PP_UPDATE_COUNTER()</span></div>
</div><!-- fragment --><p>Example: </p><div class="fragment"><div class="line">UI_WRAP_MALLOC(</div>
<div class="line"><span class="stringliteral">&quot;ptisolated&quot;</span>,</div>
<div class="line">lptisolated,</div>
<div class="line">( arg(<span class="stringliteral">&quot;image&quot;</span>), arg(<span class="stringliteral">&quot;connexity&quot;</span>) ),</div>
<div class="line">doc__ptisolated__c__</div>
<div class="line">);</div>
<div class="line"><span class="preprocessor">#include BOOST_PP_UPDATE_COUNTER()</span></div>
</div><!-- fragment --><h1><a class="anchor" id="advanced"></a>
Advanced</h1>
<p>This file contains C++ macro language and template metaprogramming, which is difficult to understand. The file is first treated with the preprocessor. The generated code looks like this:</p>
<div class="fragment"><div class="line"><span class="comment">// the wrapper uses boost enable_if class for conditional compilation</span></div>
<div class="line"><span class="comment">// this is the base class declaration</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <span class="keyword">class</span> enabled = <span class="keywordtype">void</span>&gt;</div>
<div class="line"><span class="keyword">struct </span>instance0 { };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// for every number of arguments there is a special wrapper </span></div>
<div class="line"><span class="comment">// the above instantiation only occurs if the number of arguments</span></div>
<div class="line"><span class="comment">// (including the &#39;image&#39; object) is 1</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> FA&gt;</div>
<div class="line"><span class="keyword">struct </span>instance0&lt; FA, typename enable_if&lt; is_same&lt;FA, int_&lt;1&gt; &gt; &gt;::type &gt;</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Fn, <span class="keyword">class</span> Args&gt;</div>
<div class="line">  <span class="keywordtype">void</span> define(<span class="keyword">const</span> <span class="keywordtype">char</span>* fname, Fn fn, Args args, <span class="keyword">const</span> <span class="keywordtype">char</span>* doc)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// decomposition of the function for parameters</span></div>
<div class="line">    <span class="keyword">typedef</span> <span class="keyword">struct </span>decompose&lt;Fn&gt; FT;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// for each image type in Pink the appropriate &#39;make_malloc&#39;</span></div>
<div class="line">    <span class="comment">// macro is called</span></div>
<div class="line">    def(fname, make_malloc&lt; char_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; short_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; int_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; float_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; double_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; fcomplex_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; dcomplex_image, (pink::python::ui_cheat&lt;typename FT::result_type, xvimage*, greet&gt;)&gt;, args, doc);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> FA&gt; <span class="keyword">struct </span>instance0&lt; FA, typename enable_if&lt; is_same&lt;FA, int_&lt;2&gt; &gt; &gt;::type &gt;</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Fn, <span class="keyword">class</span> Args&gt;</div>
<div class="line">  <span class="keywordtype">void</span> define(<span class="keyword">const</span> <span class="keywordtype">char</span>* fname, Fn fn, Args args, <span class="keyword">const</span> <span class="keywordtype">char</span>* doc)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">typedef</span> <span class="keyword">struct </span>decompose&lt;Fn&gt; FT;</div>
<div class="line">    def(fname, make_malloc&lt; char_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; short_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; int_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; float_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; double_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; fcomplex_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; dcomplex_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> FA&gt; <span class="keyword">struct </span>instance0&lt; FA, typename enable_if&lt; is_same&lt;FA, int_&lt;3&gt; &gt; &gt;::type &gt;</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> Fn, <span class="keyword">class</span> Args&gt;</div>
<div class="line">  <span class="keywordtype">void</span> define(<span class="keyword">const</span> <span class="keywordtype">char</span>* fname, Fn fn, Args args, <span class="keyword">const</span> <span class="keywordtype">char</span>* doc)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">typedef</span> <span class="keyword">struct </span>decompose&lt;Fn&gt; FT;</div>
<div class="line">    def(fname, make_malloc&lt; char_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; short_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; int_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; float_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; double_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; fcomplex_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">    def(fname, make_malloc&lt; dcomplex_image, <span class="keyword">typename</span> xv2pink&lt; typename FT::T1 &gt;::type, <span class="keyword">typename</span> xv2pink&lt; typename FT::T2 &gt;::type, greet&gt;, args, doc);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// this function does the first decomposition and the </span></div>
<div class="line"><span class="comment">// appropriate wrapper class instantiation</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> Fn, <span class="keyword">class</span> Args&gt;</div>
<div class="line"><span class="keywordtype">void</span> call0(<span class="keyword">const</span> <span class="keywordtype">char</span>* fname, Fn fn, Args args, <span class="keyword">const</span> <span class="keywordtype">char</span>* doc)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> FA = decompose&lt;Fn&gt;::arity;</div>
<div class="line">  instance0&lt; int_&lt;FA&gt; &gt; wrapped_function;</div>
<div class="line">  wrapped_function.define(fname, fn, args, doc);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// this is a helper function so we wouldn&#39;t have to </span></div>
<div class="line"><span class="comment">// call call0 again in &#39;BOOST_PYTHON_MODULE&#39;</span></div>
<div class="line"><span class="keywordtype">void</span> export_function0()</div>
<div class="line">{</div>
<div class="line">  call0(<span class="stringliteral">&quot;greet&quot;</span>, greet, (arg(<span class="stringliteral">&quot;image&quot;</span>), (arg(<span class="stringliteral">&quot;int&quot;</span>))), <span class="stringliteral">&quot;WRITE ME!!&quot;</span>);</div>
<div class="line">};</div>
</div><!-- fragment --><p>The macro generates the wrapper 'instance' for each number of parameters. The template takes the specified parameters and wraps the function in Python. The most important part of the macro is the conversion of the 'xvimage*' pointer into the appropriate image class (like 'char_image'). </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
